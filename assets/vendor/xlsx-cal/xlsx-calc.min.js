/*! xlsx-calc shim loader (local file) */
(function(){
  var g = (typeof window!=='undefined') ? window : globalThis;
  if (g.XLSX_CALC) return; // already loaded
  var tried = false, done=false, q=[];
  function ready(fn){ if (g.XLSX_CALC) fn(g.XLSX_CALC); else q.push(fn); }
  function flush(){
    while(q.length){ try{ q.shift()(g.XLSX_CALC); }catch(e){ console && console.error(e); } }
  }
  function inject(u){
    var s=document.createElement('script');
    s.src=u; s.async=true; s.onload=function(){ done=true; flush(); };
    s.onerror=function(){ console && console.warn('xlsx-calc load failed:', u); };
    document.head.appendChild(s);
  }
  // primary CDN + a fallback
  var cdns = [
    "https://cdn.jsdelivr.net/npm/xlsx-calc@0.6.11/dist/xlsx-calc.min.js",
    "https://unpkg.com/xlsx-calc@0.6.11/dist/xlsx-calc.min.js"
  ];
  // kick
  if (typeof document!=='undefined' && !tried){
    tried = true; for (var i=0;i<cdns.length;i++) inject(cdns[i]);
  }
  // expose a tiny ensure function for callers if they want
  g.__ensure_xlsx_calc__ = function(cb){ ready(cb||function(){}); };
})();
