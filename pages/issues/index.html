<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Issues & Actions | PHD Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <style>
        :root{ --ink:#0f172a; --muted:#6b7280; --line:#e5e7eb; --soft:#f8fafc; --brand:#6d28d9; --radius:14px; --boxH:36px; }
        .settings-page{flex:1 1 auto; display:flex; flex-direction:column; min-height:0;}
        .container-page{max-width:1280px; margin:0 auto; padding:16px 18px 12px; display:flex; flex-direction:column; min-height:0;}
        .page-head{display:flex; flex-direction:column; gap:10px; margin-bottom:12px;}
        .page-head .breadcrumb{color:var(--muted)}
        .page-body{flex:1 1 auto; min-height:0; display:flex; justify-content:center;}
        .centered-card{max-width:1200px; border:1px solid #eef0f4; border-radius:var(--radius); background:#fff;}
        .toolbar{display:flex; align-items:center; gap:12px; flex-wrap:wrap;}
        .seg{border:1px solid #e5e7eb;border-radius:10px;overflow:hidden}
        .segbtn{background:#fff;border:0;padding:.35rem .6rem;font-size:.85rem}
        .segbtn+ .segbtn{border-left:1px solid #e5e7eb}
        .segbtn.active{background:#f3f4f6;font-weight:600}
        .table thead th{white-space:nowrap; background:#fff; position:sticky; top:0; z-index:5; border-bottom:1px solid var(--line); cursor:pointer;}
        .table-responsive{max-height:64vh; overflow:auto; border-radius:12px; border:1px solid #eef0f4}
        .skel{position:relative; overflow:hidden; background:#f3f4f6; height:44px; border-radius:8px}
        .skel::after{content:""; position:absolute; inset:0; transform:translateX(-100%);
          background:linear-gradient(90deg,transparent,rgba(255,255,255,.7),transparent);
          animation:shimmer 1.05s infinite linear}
        @keyframes shimmer{100%{transform:translateX(100%)}}
        .badge-status{font-weight:600;padding:.25rem .5rem;border-radius:.5rem;border:1px solid transparent}
        .status-pending{background:#fff7ed;color:#c2410c;border-color:#fed7aa}
        .status-progress{background:#ecfeff;color:#155e75;border-color:#a5f3fc}
        .status-done{background:#ecfdf5;color:#065f46;border-color:#a7f3d0}
        .status-blocked{background:#fef2f2;color:#991b1b;border-color:#fecaca}
        button.btn-del{ display:none; } html.is-super button.btn-del{ display:inline-flex; }
    </style>
</head>
<body>
<div class="settings-page">
    <div class="container-page">
        <div class="page-head">
            <div class="d-flex align-items-center gap-2">
                <h1 class="h4 m-0">បញ្ហាប្រឈម & សកម្មភាព</h1>
                <nav aria-label="breadcrumb" class="small">
                    <ol class="breadcrumb m-0">
                        <li class="breadcrumb-item"><a href="#/">Dashboard</a></li>
                        <li class="breadcrumb-item">Reports</li>
                        <li class="breadcrumb-item active" aria-current="page">Issues</li>
                    </ol>
                </nav>
            </div>
            <div class="separator-breadcrumb border-top"></div>
        </div>

        <div class="page-body">
            <div class="card shadow-sm centered-card w-100">
                <div class="card-body">
                    <div class="toolbar mb-3">
                        <h4 class="card-title m-0">បញ្ជីបញ្ហាប្រឈម</h4>
                        <div class="ms-auto d-flex flex-wrap align-items-end gap-2">
                            <div class="seg d-inline-flex">
                                <button type="button" class="segbtn active" data-type="all">All</button>
                                <button type="button" class="segbtn" data-type="month">Month</button>
                                <button type="button" class="segbtn" data-type="quarter">Quarter</button>
                                <button type="button" class="segbtn" data-type="half">Half</button>
                                <button type="button" class="segbtn" data-type="year">Year</button>
                            </div>
                            <div>
                                <label class="form-label small m-0">Year</label>
                                <select id="ySel" class="form-select form-select-sm" style="min-width:120px"></select>
                            </div>
                            <div id="tagWrap" style="display:none">
                                <label class="form-label small m-0">Tag</label>
                                <select id="tagSel" class="form-select form-select-sm" style="min-width:140px"></select>
                            </div>
                            <div class="d-flex gap-2">
                                <button id="btnApply" class="btn btn-sm btn-primary">Apply</button>
                                <button id="btnReset" class="btn btn-sm btn-outline-secondary">Reset</button>
                                <button id="btnDownloadPdf" class="btn btn-sm btn-outline-dark">ទាញយក PDF</button>
                            </div>
                        </div>
                    </div>

                    <div id="issuesSummary" class="mb-2 small text-muted">Loading…</div>

                    <div class="table-responsive">
                        <table id="tblIssues" class="table table-striped align-middle mb-0">
                            <colgroup>
                                <col style="width:320px"><col style="width:120px"><col><col>
                                <col style="width:180px"><col style="width:120px"><col style="width:220px">
                            </colgroup>
                            <thead>
                            <tr>
                                <th>សូចនាករ</th>
                                <th>រយៈពេល</th>
                                <th>បញ្ហាប្រឈម</th>
                                <th>សកម្មភាព</th>
                                <th>អ្នកទទួលខុសត្រូវ</th>
                                <th>កំណត់ពេល</th>
                                <th>ស្ថានភាព / សកម្មភាព</th>
                            </tr>
                            </thead>
                            <tbody><!-- render by JS --></tbody>
                        </table>
                    </div>

                    <!-- កន្លែងសម្រាប់ render PDF ជា client-side (បើចង់) -->
                    <div id="pdfComposer" hidden></div>

                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>

